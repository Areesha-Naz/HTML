<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Log In - Meeting Scheduler</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 font-sans overflow-x-hidden">
    <div class="flex items-center justify-center min-h-screen">
        <div class="flex w-full max-w-4xl lg:max-w-5xl bg-white shadow-2xl rounded-2xl overflow-hidden m-4">
            <!-- Left Side: Informational Content -->
            <div class="hidden lg:flex flex-col justify-center items-center w-1/2 bg-blue-600 text-white p-12 text-center">
                <h1 class="text-4xl font-bold mb-3">Streamline Your Scheduling</h1>
                <p class="text-blue-100 mb-8">
                    Connect, collaborate, and conquer your day. Our platform makes scheduling meetings effortless, so
                    you can focus on what truly matters.
                </p>
                <img src="https://storage.googleapis.com/gweb-uniblog-publish-prod/images/new_2020_hero.max-1000x1000.png"
                    alt="Meeting Illustration" class="w-3/4 max-h-64 object-cover opacity-90">
            </div>

            <!-- Right Side: Login Form -->
            <div class="w-full lg:w-1/2 p-8 sm:p-12">
                <h1 class="text-3xl font-bold text-center mb-2">Welcome Back</h1>
                <p class="text-gray-500 text-center mb-8">Log in to continue to your meeting scheduler.</p>

                <form id="login-form" class="space-y-6">
                    <div>
                        <label for="email" class="text-sm font-medium text-gray-700">Email Address</label>
                        <input type="email" id="email" required
                            class="mt-1 border rounded-lg w-full px-4 py-2 outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <div class="flex justify-between items-center">
                            <label for="password" class="text-sm font-medium text-gray-700">Password</label>
                            <a href="javascript:void(0);" id="forgot-password-link"
                                class="text-xs text-blue-600 hover:underline">Forgot Password?</a>
                        </div>
                        <input type="password" id="password" required
                            class="mt-1 border rounded-lg w-full px-4 py-2 outline-none focus:ring-2 focus:ring-blue-500">
                    </div>

                    <button type="submit"
                        class="w-full bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 font-semibold">
                        Log In
                    </button>
                </form>

                <div class="relative flex items-center py-5">
                    <div class="flex-grow border-t border-gray-300"></div>
                    <span class="mx-4 flex-shrink text-sm text-gray-400">OR</span>
                    <div class="flex-grow border-t border-gray-300"></div>
                </div>

                <div class="space-y-3">
                    <button id="google-login-btn"
                        class="w-full flex items-center justify-center gap-3 border border-gray-300 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-100 font-semibold">
                        <img src="https://www.google.com/s2/favicons?domain=google.com" alt="Google logo" class="h-5">
                        Continue with Google
                    </button>
                    <button
                        class="w-full flex items-center justify-center gap-3 border border-gray-300 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-100 font-semibold">
                        <img src="https://www.apple.com/favicon.ico" alt="Apple logo" class="h-5">
                        Continue with Apple
                    </button>
                </div>

                <p class="text-center text-sm text-gray-600 mt-8">
                    Don't have an account?
                    <a href="signup.html" class="font-medium text-blue-600 hover:underline">Sign Up</a>
                </p>
            </div>
        </div>
    </div>

    <!-- Forgot Password Modal -->
    <div id="forgot-password-modal"
        class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50">
        <div class="relative top-20 mx-auto p-6 border w-full max-w-md shadow-lg rounded-xl bg-white">
            <div class="mt-3">
                <h3 class="text-xl leading-6 font-bold text-gray-900 text-center">Password Recovery</h3>
                <div class="mt-4">
                    <p class="text-sm text-gray-500 text-center mb-4">Enter your email to recover your password.</p>
                    <input type="email" id="modal-recovery-email" placeholder="your.email@example.com"
                        class="w-full px-4 py-3 text-gray-700 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" />
                </div>
                <div class="mt-6 flex justify-end gap-3">
                    <button id="modal-cancel-recovery-btn"
                        class="px-6 py-2 bg-gray-200 text-gray-800 text-base font-medium rounded-lg hover:bg-gray-300 focus:outline-none">
                        Cancel
                    </button>
                    <button id="modal-submit-recovery-btn"
                        class="px-6 py-2 bg-blue-600 text-white text-base font-medium rounded-lg hover:bg-blue-700 focus:outline-none">
                        Submit
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const loginForm = document.getElementById('login-form');
            const googleLoginBtn = document.getElementById('google-login-btn');
            const forgotPasswordLink = document.getElementById('forgot-password-link');
            const forgotPasswordModal = document.getElementById('forgot-password-modal');
            const modalRecoveryEmailInput = document.getElementById('modal-recovery-email');
            const modalSubmitRecoveryBtn = document.getElementById('modal-submit-recovery-btn');
            const modalCancelRecoveryBtn = document.getElementById('modal-cancel-recovery-btn');

            const showToast = (message, type = 'success') => {
                const toast = document.createElement('div');
                const bgColor = type === 'success' ? 'bg-green-500' : 'bg-red-500';
                toast.className = `fixed bottom-5 right-5 text-white px-6 py-3 rounded-lg shadow-lg ${bgColor} z-50 transition-opacity duration-300`;
                toast.textContent = message;
                document.body.appendChild(toast);
                setTimeout(() => toast.remove(), 3000);
            };

            loginForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                const users = JSON.parse(localStorage.getItem('appUsers')) || [];
                const user = users.find(u => u.email === email && u.password === password);

                if (user) {
                    localStorage.setItem('currentUserEmail', user.email);
                    window.location.href = 'index.html';
                } else {
                    showToast('Invalid email or password.', 'error');
                }
            });

            googleLoginBtn.addEventListener('click', () => {
                const googleUserEmail = prompt("Please enter your Google email to sign in:");

                if (!googleUserEmail || !googleUserEmail.includes('@')) {
                    showToast('Please enter a valid email address.', 'error');
                    return;
                }

                let users = JSON.parse(localStorage.getItem('appUsers')) || [];
                let user = users.find(u => u.email === googleUserEmail);

                if (!user) {
                    const newUser = { email: googleUserEmail, password: 'google_login' };
                    users.push(newUser);
                    localStorage.setItem('appUsers', JSON.stringify(users));

                    const newUserProfile = {
                        fullName: 'Google User',
                        email: googleUserEmail,
                        role: 'User',
                        profilePicture: null
                    };
                    localStorage.setItem(`userProfile_${googleUserEmail}`, JSON.stringify(newUserProfile));
                }
                localStorage.setItem('currentUserEmail', googleUserEmail);
                window.location.href = 'index.html';
            });

            const closeRecoveryModal = () => {
                forgotPasswordModal.classList.add('hidden');
                modalRecoveryEmailInput.value = '';
            };

            forgotPasswordLink.addEventListener('click', () => {
                forgotPasswordModal.classList.remove('hidden');
            });

            modalCancelRecoveryBtn.addEventListener('click', closeRecoveryModal);

            modalSubmitRecoveryBtn.addEventListener('click', () => {
                const email = modalRecoveryEmailInput.value;

                if (!email || !email.includes('@')) {
                    showToast('Please enter a valid email address.', 'error');
                    return;
                }

                const users = JSON.parse(localStorage.getItem('appUsers')) || [];
                const user = users.find(u => u.email === email);

                if (user) {
                    showToast(`Password for ${user.email} is: ${user.password}`, 'success');
                } else {
                    showToast('No account found with that email address.', 'error');
                }
                closeRecoveryModal();
            });
        });
    </script>
</body>
</html>